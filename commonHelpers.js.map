{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst iconLeft = new URL('/img/icons/arrow-icons.svg#icon-left', import.meta.url).href; \nconst iconRight = new URL('/img/icons/arrow-icons.svg#icon-right', import.meta.url).href; \nconst iconError = new URL('/img/icons/error-icon.svg', import.meta.url).href;\nconst iconWarn = new URL('/img/icons/warning-icon.svg', import.meta.url).href;\n\nconst LS_QUERY = 'user-query'\n\nconst gallery = document.querySelector('.gallery');\nconst galleryForm = document.querySelector('.search-photos');\nconst loader = document.querySelector('.loader-wrapper');\nconst moreBtn = document.querySelector('.more-btn');\n\nlet page = 1;\nlet limit = 40;\n\nconst informUser = (message, title = 'ERROR', icon = iconError, color = 'rgba(239, 64, 64, 1)') => {\n    iziToast.show({\n        title: title,\n        backgroundColor: color,\n        theme: 'dark',\n        message: message,\n        position: 'topRight',\n        timeout: 5000,\n        iconUrl: icon,\n    });\n};\n\nconst getTotalPages = (images) => {\n    return Math.ceil(images.totalHits / limit);\n}\n\nconst getPhotos = async (userQuery) => {\n\n    const response = await axios.get(`https://pixabay.com/api/`, {\n        params: {\n            key: '41527103-e0775164a767d3baf6162359a',\n            q: encodeURIComponent(userQuery).replace(/%20/g, '+'),\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            per_page: limit,\n            page: page,\n        }\n    })\n    return response.data;\n};\n    const renderImages = (images) => {\n        const allImages = images.hits;\n        if (images.totalHits === 0) {\n            loader.classList.add('visually-hidden');\n            moreBtn.classList.add('visually-hidden');\n            return informUser('Sorry, there are no images matching your search query. Please, try again!');\n        }\n        else {\n            const galleryMarkup = allImages.map(({ webformatURL: preview, largeImageURL: original, tags: description }) => {\n                return `\n                        <li class=\"gallery-item\">\n                            <a class=\"gallery-link\" href=\"${original}\">\n                                <img\n                                    loading=\"lazy\"\n                                    class=\"gallery-image\"\n                                    src=\"${preview}\"\n                                    alt=\"${description}\"\n                                />\n                            </a>\n                        </li>\n                        `\n            }).join('');\n            gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n            const lightbox = new SimpleLightbox('.gallery a', {\n                navText: [\n                    `<svg width=\"24\" height=\"24\"><use href=\"${iconLeft}\"></svg>`,\n                    `<svg width=\"24\" height=\"24\"><use href=\"${iconRight}\"></svg>`\n                ],\n                captionsData: \"alt\",\n                captionDelay: false,\n            });\n            lightbox.refresh();\n            loader.classList.add('visually-hidden');\n        };\n    };\n\nconst onClick = async () => {\n    try {\n        page += 1;\n        const images = await getPhotos(sessionStorage.getItem(LS_QUERY));\n        const totalPages = getTotalPages(images);\n        if (page === totalPages) {\n            moreBtn.classList.add('visually-hidden');\n            informUser('The end of collection has been reached', 'INFO', iconWarn, 'rgba(167, 166, 145, 1)');\n        };\n        renderImages(images);\n    }\n    catch (error) {\n        informUser(error.message);\n    }\n };\n\nconst handleSubmit = async (e) => {\n    e.preventDefault();\n    gallery.innerHTML = '';\n    loader.classList.remove('visually-hidden');\n    const userQuery = e.target.elements[0].value.trim().toLowerCase().toString();\n    sessionStorage.setItem(LS_QUERY, userQuery);\n    page = 1;\n    const images = await getPhotos(userQuery);\n    const totalPages = getTotalPages(images);\n    renderImages(images);\n    if (page === totalPages) {\n        moreBtn.classList.add('visually-hidden');\n        informUser('The end of collection has been reached', 'INFO', iconWarn, 'rgba(167, 166, 145, 1)');\n    }\n    else if (page < totalPages) {\n        moreBtn.classList.remove('visually-hidden');\n    };\n    e.target.reset();\n };\n\ngalleryForm.addEventListener('submit', handleSubmit);\nmoreBtn.addEventListener('click', onClick);"],"names":["iconLeft","iconRight","iconError","iconWarn","LS_QUERY","gallery","galleryForm","loader","moreBtn","page","limit","informUser","message","title","icon","color","iziToast","getTotalPages","images","getPhotos","userQuery","axios","renderImages","allImages","galleryMarkup","preview","original","description","SimpleLightbox","onClick","totalPages","error","handleSubmit"],"mappings":"owBAMA,MAAMA,EAAW,IAAgE,IAAA,2DAAA,KAAA,QAAA,EAAC,KAC5EC,EAAY,IAAiE,IAAA,4DAAA,KAAA,QAAA,EAAC,KAC9EC,EAAY,IAAA,IAAA,gDAAA,KAAA,QAAA,EAAsD,KAClEC,EAAW,IAAA,IAAA,kDAAA,KAAA,QAAA,EAAwD,KAEnEC,EAAW,aAEXC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAS,SAAS,cAAc,iBAAiB,EACjDC,EAAU,SAAS,cAAc,WAAW,EAElD,IAAIC,EAAO,EACPC,EAAQ,GAEZ,MAAMC,EAAa,CAACC,EAASC,EAAQ,QAASC,EAAOZ,EAAWa,EAAQ,yBAA2B,CAC/FC,EAAS,KAAK,CACV,MAAOH,EACP,gBAAiBE,EACjB,MAAO,OACP,QAASH,EACT,SAAU,WACV,QAAS,IACT,QAASE,CACjB,CAAK,CACL,EAEMG,EAAiBC,GACZ,KAAK,KAAKA,EAAO,UAAYR,CAAK,EAGvCS,EAAY,MAAOC,IAEJ,MAAMC,EAAM,IAAI,2BAA4B,CACzD,OAAQ,CACJ,IAAK,qCACL,EAAG,mBAAmBD,CAAS,EAAE,QAAQ,OAAQ,GAAG,EACpD,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUV,EACV,KAAMD,CACT,CACT,CAAK,GACe,KAEVa,EAAgBJ,GAAW,CAC7B,MAAMK,EAAYL,EAAO,KACzB,GAAIA,EAAO,YAAc,EACrB,OAAAX,EAAO,UAAU,IAAI,iBAAiB,EACtCC,EAAQ,UAAU,IAAI,iBAAiB,EAChCG,EAAW,2EAA2E,EAE5F,CACD,MAAMa,EAAgBD,EAAU,IAAI,CAAC,CAAE,aAAcE,EAAS,cAAeC,EAAU,KAAMC,CAAW,IAC7F;AAAA;AAAA,4DAEqCD;AAAA;AAAA;AAAA;AAAA,2CAIjBD;AAAA,2CACAE;AAAA;AAAA;AAAA;AAAA,yBAK9B,EAAE,KAAK,EAAE,EACVtB,EAAQ,mBAAmB,YAAamB,CAAa,EACpC,IAAII,EAAe,aAAc,CAC9C,QAAS,CACL,0CAA0C5B,YAC1C,0CAA0CC,WAC7C,EACD,aAAc,MACd,aAAc,EAC9B,CAAa,EACQ,QAAO,EAChBM,EAAO,UAAU,IAAI,iBAAiB,CAClD,GAGMsB,EAAU,SAAY,CACxB,GAAI,CACApB,GAAQ,EACR,MAAMS,EAAS,MAAMC,EAAU,eAAe,QAAQf,CAAQ,CAAC,EACzD0B,EAAab,EAAcC,CAAM,EACnCT,IAASqB,IACTtB,EAAQ,UAAU,IAAI,iBAAiB,EACvCG,EAAW,yCAA0C,OAAQR,EAAU,wBAAwB,GAEnGmB,EAAaJ,CAAM,CACtB,OACMa,EAAP,CACIpB,EAAWoB,EAAM,OAAO,CAC3B,CACL,EAEMC,EAAe,MAAO,GAAM,CAC9B,EAAE,eAAc,EAChB3B,EAAQ,UAAY,GACpBE,EAAO,UAAU,OAAO,iBAAiB,EACzC,MAAMa,EAAY,EAAE,OAAO,SAAS,GAAG,MAAM,KAAM,EAAC,YAAa,EAAC,SAAQ,EAC1E,eAAe,QAAQhB,EAAUgB,CAAS,EAC1CX,EAAO,EACP,MAAMS,EAAS,MAAMC,EAAUC,CAAS,EAClCU,EAAab,EAAcC,CAAM,EACvCI,EAAaJ,CAAM,EACfT,IAASqB,GACTtB,EAAQ,UAAU,IAAI,iBAAiB,EACvCG,EAAW,yCAA0C,OAAQR,EAAU,wBAAwB,GAE1FM,EAAOqB,GACZtB,EAAQ,UAAU,OAAO,iBAAiB,EAE9C,EAAE,OAAO,OACb,EAEAF,EAAY,iBAAiB,SAAU0B,CAAY,EACnDxB,EAAQ,iBAAiB,QAASqB,CAAO"}