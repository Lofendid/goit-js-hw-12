{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst iconLeft = new URL('../img/icons/arrow-icons.svg#icon-left', import.meta.url).href; \nconst iconRight = new URL('../img/icons/arrow-icons.svg#icon-right', import.meta.url).href; \nconst iconError = new URL('/img/icons/error-icon.svg', import.meta.url).href;\n\nconst LS_QUERY = 'user-query'\n\nconst gallery = document.querySelector('.gallery');\nconst galleryForm = document.querySelector('.search-photos');\nconst loader = document.querySelector('.loader-wrapper');\nconst moreBtn = document.querySelector('.more-btn');\n\nlet page = 1;\nlet limit = 9;\n\nconst mistake = (message) => {\n    iziToast.show({\n        title: 'ERROR',\n        backgroundColor: 'rgba(239, 64, 64, 1)',\n        theme: 'dark',\n        message: message,\n        position: 'topRight',\n        timeout: 5000,\n        iconUrl: iconError,\n    });\n};\n\nconst getTotalPages = (images) => {\n    return Math.ceil(images.totalHits / limit);\n}\n\nconst getPhotos = async (userQuery) => {\n\n    const response = await axios.get(`https://pixabay.com/api/`, {\n        params: {\n            key: '41527103-e0775164a767d3baf6162359a',\n            q: encodeURIComponent(userQuery).replace(/%20/g, '+'),\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            per_page: limit,\n            page: page,\n        }\n    })\n    return response.data;\n};\n    const renderImages = (images) => {\n        const allImages = images.hits;\n        if (images.totalHits === 0) {\n            loader.classList.add('visually-hidden');\n            return mistake('Sorry, there are no images matching your search query. Please, try again!');\n        }\n        else {\n            const galleryMarkup = allImages.map(({ webformatURL: preview, largeImageURL: original, tags: description }) => {\n                return `\n                        <li class=\"gallery-item\">\n                            <a class=\"gallery-link\" href=\"${original}\">\n                                <img\n                                    loading=\"lazy\"\n                                    class=\"gallery-image\"\n                                    src=\"${preview}\"\n                                    alt=\"${description}\"\n                                />\n                            </a>\n                        </li>\n                        `\n            }).join('');\n            gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n            const lightbox = new SimpleLightbox('.gallery a', {\n                navText: [\n                    `<svg width=\"24\" height=\"24\"><use href=\"${iconLeft}\"></svg>`,\n                    `<svg width=\"24\" height=\"24\"><use href=\"${iconRight}\"></svg>`\n                ],\n                captionsData: \"alt\",\n                captionDelay: false,\n            });\n            lightbox.refresh();\n            loader.classList.add('visually-hidden');\n        };\n    };\n\nconst onClick = async () => {\n    try {\n        page += 1;\n        const images = await getPhotos(sessionStorage.getItem(LS_QUERY));\n        const totalPages = getTotalPages(images);\n        if (page === totalPages) {\n            moreBtn.classList.add('visually-hidden');\n            mistake('The end of collection has been reached')\n        };\n        renderImages(images);\n    }\n    catch (error) {\n        mistake(error.message);\n    }\n };\n\nconst handleSubmit = async (e) => {\n    e.preventDefault();\n    gallery.innerHTML = '';\n    loader.classList.remove('visually-hidden');\n    const userQuery = e.target.elements[0].value.trim().toLowerCase().toString();\n    sessionStorage.setItem(LS_QUERY, userQuery);\n    page = 1;\n    const images = await getPhotos(userQuery);\n    const totalPages = getTotalPages(images);\n    renderImages(images);\n    if (page === totalPages) {\n        moreBtn.classList.add('visually-hidden');\n    }\n    else if (page < totalPages) {\n        moreBtn.classList.remove('visually-hidden');\n    };\n    e.target.reset();\n };\n\ngalleryForm.addEventListener('submit', handleSubmit);\nmoreBtn.addEventListener('click', onClick);"],"names":["iconLeft","iconRight","iconError","LS_QUERY","gallery","galleryForm","loader","moreBtn","page","limit","mistake","message","iziToast","getTotalPages","images","getPhotos","userQuery","axios","renderImages","allImages","galleryMarkup","preview","original","description","SimpleLightbox","onClick","totalPages","error","handleSubmit"],"mappings":"owBAMA,MAAMA,EAAW,IAAkE,IAAA,yCAAA,KAAA,QAAA,EAAC,KAC9EC,EAAY,IAAmE,IAAA,0CAAA,KAAA,QAAA,EAAC,KAChFC,EAAY,IAAA,IAAA,gDAAA,KAAA,QAAA,EAAsD,KAElEC,EAAW,aAEXC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAS,SAAS,cAAc,iBAAiB,EACjDC,EAAU,SAAS,cAAc,WAAW,EAElD,IAAIC,EAAO,EACPC,EAAQ,EAEZ,MAAMC,EAAWC,GAAY,CACzBC,EAAS,KAAK,CACV,MAAO,QACP,gBAAiB,uBACjB,MAAO,OACP,QAASD,EACT,SAAU,WACV,QAAS,IACT,QAAST,CACjB,CAAK,CACL,EAEMW,EAAiBC,GACZ,KAAK,KAAKA,EAAO,UAAYL,CAAK,EAGvCM,EAAY,MAAOC,IAEJ,MAAMC,EAAM,IAAI,2BAA4B,CACzD,OAAQ,CACJ,IAAK,qCACL,EAAG,mBAAmBD,CAAS,EAAE,QAAQ,OAAQ,GAAG,EACpD,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUP,EACV,KAAMD,CACT,CACT,CAAK,GACe,KAEVU,EAAgBJ,GAAW,CAC7B,MAAMK,EAAYL,EAAO,KACzB,GAAIA,EAAO,YAAc,EACrB,OAAAR,EAAO,UAAU,IAAI,iBAAiB,EAC/BI,EAAQ,2EAA2E,EAEzF,CACD,MAAMU,EAAgBD,EAAU,IAAI,CAAC,CAAE,aAAcE,EAAS,cAAeC,EAAU,KAAMC,CAAW,IAC7F;AAAA;AAAA,4DAEqCD;AAAA;AAAA;AAAA;AAAA,2CAIjBD;AAAA,2CACAE;AAAA;AAAA;AAAA;AAAA,yBAK9B,EAAE,KAAK,EAAE,EACVnB,EAAQ,mBAAmB,YAAagB,CAAa,EACpC,IAAII,EAAe,aAAc,CAC9C,QAAS,CACL,0CAA0CxB,YAC1C,0CAA0CC,WAC7C,EACD,aAAc,MACd,aAAc,EAC9B,CAAa,EACQ,QAAO,EAChBK,EAAO,UAAU,IAAI,iBAAiB,CAClD,GAGMmB,EAAU,SAAY,CACxB,GAAI,CACAjB,GAAQ,EACR,MAAMM,EAAS,MAAMC,EAAU,eAAe,QAAQZ,CAAQ,CAAC,EACzDuB,EAAab,EAAcC,CAAM,EACnCN,IAASkB,IACTnB,EAAQ,UAAU,IAAI,iBAAiB,EACvCG,EAAQ,wCAAwC,GAEpDQ,EAAaJ,CAAM,CACtB,OACMa,EAAP,CACIjB,EAAQiB,EAAM,OAAO,CACxB,CACL,EAEMC,EAAe,MAAO,GAAM,CAC9B,EAAE,eAAc,EAChBxB,EAAQ,UAAY,GACpBE,EAAO,UAAU,OAAO,iBAAiB,EACzC,MAAMU,EAAY,EAAE,OAAO,SAAS,GAAG,MAAM,KAAM,EAAC,YAAa,EAAC,SAAQ,EAC1E,eAAe,QAAQb,EAAUa,CAAS,EAC1CR,EAAO,EACP,MAAMM,EAAS,MAAMC,EAAUC,CAAS,EAClCU,EAAab,EAAcC,CAAM,EACvCI,EAAaJ,CAAM,EACfN,IAASkB,EACTnB,EAAQ,UAAU,IAAI,iBAAiB,EAElCC,EAAOkB,GACZnB,EAAQ,UAAU,OAAO,iBAAiB,EAE9C,EAAE,OAAO,OACb,EAEAF,EAAY,iBAAiB,SAAUuB,CAAY,EACnDrB,EAAQ,iBAAiB,QAASkB,CAAO"}